<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serenity ‚Äî Personal Wellness Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600&family=Cormorant+Garamond:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #faf8ff;
            --bg-secondary: #ffffff;
            --bg-accent: #f3f0fa;
            --bg-card: #ffffff;
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --text-muted: #8b93a7;
            --lavender: #9b7fd4;
            --lavender-soft: #e6dff5;
            --lavender-rich: #7c5bbf;
            --sage: #5fa886;
            --sage-soft: #d8f0e3;
            --sage-rich: #3d8b65;
            --sky: #5da4c7;
            --sky-soft: #dbeef7;
            --sky-rich: #3a89b5;
            --peach: #e89b7b;
            --peach-soft: #fde8df;
            --coral: #e07b7b;
            --rose: #d67a8f;
            --rose-soft: #fae0e6;
            --gold: #d4a85a;
            --gold-soft: #faf3e0;
            --teal: #4ab3a8;
            --teal-soft: #d5f2ef;
            --shadow-soft: 0 2px 20px rgba(100, 80, 140, 0.1);
            --shadow-medium: 0 4px 30px rgba(100, 80, 140, 0.15);
            --shadow-glow: 0 0 40px rgba(155, 127, 212, 0.3);
            --radius: 20px;
            --radius-sm: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --input-bg: #ffffff;
            --border-color: #e2e8f0;
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --bg-primary: #1a1625;
            --bg-secondary: #241f31;
            --bg-accent: #2d2640;
            --bg-card: #2d2640;
            --text-primary: #e8e4f0;
            --text-secondary: #b8b0c8;
            --text-muted: #8b839c;
            --lavender-soft: #3d3354;
            --sage-soft: #2a3d32;
            --sky-soft: #2a3540;
            --peach-soft: #3d3230;
            --rose-soft: #3d2d35;
            --gold-soft: #3d3525;
            --teal-soft: #253d3a;
            --shadow-soft: 0 2px 20px rgba(0, 0, 0, 0.3);
            --shadow-medium: 0 4px 30px rgba(0, 0, 0, 0.4);
            --input-bg: #2d2640;
            --border-color: #3d3354;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 260px;
            background: var(--bg-secondary);
            padding: 2rem 1.5rem;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-soft);
            position: fixed;
            height: 100vh;
            z-index: 100;
        }

        .logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            font-weight: 500;
            background: linear-gradient(135deg, var(--lavender-rich) 0%, var(--teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: 0.02em;
        }

        .logo-subtitle {
            font-size: 0.75rem;
            color: var(--lavender);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 2.5rem;
            font-weight: 600;
        }

        .nav-menu {
            list-style: none;
            flex: 1;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.875rem;
            padding: 0.875rem 1rem;
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            transition: var(--transition);
            cursor: pointer;
        }

        .nav-link:hover {
            background: var(--bg-accent);
            color: var(--text-primary);
        }

        .nav-link.active {
            background: linear-gradient(135deg, var(--lavender-soft) 0%, #f0e6ff 100%);
            color: var(--lavender-rich);
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(155, 127, 212, 0.15);
        }

        .nav-icon {
            font-size: 1.25rem;
            width: 28px;
            text-align: center;
        }

        .current-date {
            padding: 1rem;
            background: var(--bg-accent);
            border-radius: var(--radius-sm);
            text-align: center;
            margin-top: auto;
        }

        .current-date-day {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .current-date-full {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 200;
            background: var(--bg-secondary);
            border: none;
            padding: 0.75rem;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-soft);
            cursor: pointer;
            font-size: 1.5rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 2rem;
            min-height: 100vh;
        }

        .section {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            margin-bottom: 2rem;
        }

        .section-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.25rem;
            font-weight: 400;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .section-subtitle {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            padding: 1.75rem;
            box-shadow: var(--shadow-soft);
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--lavender) 0%, var(--lavender-rich) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(155, 127, 212, 0.4);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--lavender-rich) 0%, #6a4aad 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(124, 91, 191, 0.5);
        }

        .btn-secondary {
            background: var(--bg-accent);
            color: var(--text-secondary);
        }

        .btn-secondary:hover {
            background: var(--lavender-soft);
        }

        .btn-soft {
            background: transparent;
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
        }

        .btn-soft:hover {
            background: var(--bg-accent);
        }

        /* Form Elements */
        textarea, input[type="text"] {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 1rem;
            color: var(--text-primary);
            background: var(--input-bg);
            resize: vertical;
            transition: var(--transition);
        }

        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--lavender);
        }

        textarea::placeholder, input::placeholder {
            color: var(--text-muted);
        }

        /* ==================== GRATITUDE JOURNAL ==================== */
        .gratitude-input {
            min-height: 150px;
            margin-bottom: 1rem;
        }

        .gratitude-entries {
            max-height: 500px;
            overflow-y: auto;
        }

        .gratitude-entry {
            padding: 1.25rem;
            background: linear-gradient(135deg, rgba(216, 240, 227, 0.5) 0%, rgba(255, 255, 255, 0.8) 100%);
            border-radius: var(--radius-sm);
            margin-bottom: 1rem;
            border-left: 4px solid var(--sage);
            box-shadow: 0 2px 8px rgba(95, 168, 134, 0.1);
            transition: var(--transition);
        }

        .gratitude-entry:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 15px rgba(95, 168, 134, 0.15);
        }

        .gratitude-entry-date {
            font-size: 0.75rem;
            color: var(--sage-rich);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .gratitude-entry-text {
            color: var(--text-primary);
            line-height: 1.7;
        }

        .gratitude-entry:nth-child(3n+2) {
            border-left-color: var(--lavender);
            background: linear-gradient(135deg, rgba(230, 223, 245, 0.5) 0%, rgba(255, 255, 255, 0.8) 100%);
            box-shadow: 0 2px 8px rgba(155, 127, 212, 0.1);
        }

        .gratitude-entry:nth-child(3n+2):hover {
            box-shadow: 0 4px 15px rgba(155, 127, 212, 0.15);
        }

        .gratitude-entry:nth-child(3n+2) .gratitude-entry-date {
            color: var(--lavender-rich);
        }

        .gratitude-entry:nth-child(3n) {
            border-left-color: var(--sky);
            background: linear-gradient(135deg, rgba(219, 238, 247, 0.5) 0%, rgba(255, 255, 255, 0.8) 100%);
            box-shadow: 0 2px 8px rgba(93, 164, 199, 0.1);
        }

        .gratitude-entry:nth-child(3n):hover {
            box-shadow: 0 4px 15px rgba(93, 164, 199, 0.15);
        }

        .gratitude-entry:nth-child(3n) .gratitude-entry-date {
            color: var(--sky-rich);
        }

        /* ==================== MOOD TRACKER ==================== */
        .mood-selector {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .mood-btn {
            width: 65px;
            height: 65px;
            border-radius: 50%;
            border: 3px solid transparent;
            background: var(--bg-accent);
            font-size: 1.75rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .mood-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }

        .mood-btn.selected {
            border-color: var(--lavender);
            box-shadow: 0 0 25px rgba(155, 127, 212, 0.5), 0 4px 15px rgba(0, 0, 0, 0.1);
            transform: scale(1.1);
        }

        .mood-btn[data-mood="amazing"] { 
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
        }
        .mood-btn[data-mood="good"] { 
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        .mood-btn[data-mood="okay"] { 
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        .mood-btn[data-mood="low"] { 
            background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
        }
        .mood-btn[data-mood="rough"] { 
            background: linear-gradient(135deg, #fccb90 0%, #d57eeb 100%);
        }

        .mood-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }

        .mood-calendar-header {
            text-align: center;
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 0.5rem;
        }

        .mood-day {
            aspect-ratio: 1;
            border-radius: var(--radius-sm);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            background: linear-gradient(135deg, #fafbff 0%, #f5f3fa 100%);
            position: relative;
            transition: var(--transition);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .mood-day:not(.empty):hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(155, 127, 212, 0.15);
        }

        .mood-day.empty {
            background: transparent;
            box-shadow: none;
        }

        .mood-day.today {
            box-shadow: inset 0 0 0 2px var(--lavender), 0 4px 15px rgba(155, 127, 212, 0.2);
            background: linear-gradient(135deg, var(--lavender-soft) 0%, #fff 100%);
        }

        .mood-day-number {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
            font-weight: 500;
        }

        .mood-day-emoji {
            font-size: 1.2rem;
        }

        .mood-month-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .mood-month-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
        }

        /* ==================== DAILY AFFIRMATIONS ==================== */
        .affirmation-container {
            text-align: center;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, rgba(230, 223, 245, 0.3) 0%, rgba(253, 232, 223, 0.3) 50%, rgba(216, 240, 227, 0.3) 100%);
            border-radius: var(--radius);
        }

        .affirmation-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2rem;
            font-style: italic;
            color: var(--text-primary);
            line-height: 1.6;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            background: linear-gradient(135deg, var(--lavender-rich) 0%, var(--rose) 50%, var(--coral) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .affirmation-decoration {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            filter: drop-shadow(0 4px 8px rgba(214, 122, 143, 0.3));
        }

        /* ==================== TINY WINS ==================== */
        .wins-today {
            margin-bottom: 2rem;
        }

        .win-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-accent);
            border-radius: var(--radius-sm);
            margin-bottom: 0.75rem;
            transition: var(--transition);
        }

        .win-item:hover {
            background: var(--lavender-soft);
        }

        .win-checkbox {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            border: 2px solid var(--sage);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            flex-shrink: 0;
            background: white;
        }

        .win-checkbox:hover {
            border-color: var(--sage-rich);
            box-shadow: 0 0 12px rgba(95, 168, 134, 0.3);
        }

        .win-checkbox.checked {
            background: linear-gradient(135deg, var(--sage) 0%, var(--teal) 100%);
            border-color: var(--sage-rich);
            box-shadow: 0 2px 10px rgba(95, 168, 134, 0.4);
        }

        .win-checkbox.checked::after {
            content: '‚úì';
            color: white;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .win-label {
            flex: 1;
            color: var(--text-secondary);
        }

        .win-item.completed .win-label {
            text-decoration: line-through;
            color: var(--text-muted);
        }

        .win-delete {
            opacity: 0;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.25rem;
            transition: var(--transition);
        }

        .win-item:hover .win-delete {
            opacity: 1;
        }

        .win-delete:hover {
            color: var(--rose);
        }

        .add-win-form {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .add-win-input {
            flex: 1;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            animation: celebrate 0.8s ease forwards;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes celebrate {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
        }

        .wins-history {
            max-height: 300px;
            overflow-y: auto;
        }

        .history-day {
            padding: 1rem;
            background: var(--bg-accent);
            border-radius: var(--radius-sm);
            margin-bottom: 0.75rem;
        }

        .history-date {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .history-wins {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .history-win-tag {
            padding: 0.35rem 0.875rem;
            background: linear-gradient(135deg, var(--sage-soft) 0%, var(--teal-soft) 100%);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--sage-rich);
            font-weight: 500;
            box-shadow: 0 2px 6px rgba(95, 168, 134, 0.15);
        }

        .history-win-tag:nth-child(3n+2) {
            background: linear-gradient(135deg, var(--lavender-soft) 0%, var(--rose-soft) 100%);
            color: var(--lavender-rich);
            box-shadow: 0 2px 6px rgba(155, 127, 212, 0.15);
        }

        .history-win-tag:nth-child(3n) {
            background: linear-gradient(135deg, var(--sky-soft) 0%, var(--teal-soft) 100%);
            color: var(--sky-rich);
            box-shadow: 0 2px 6px rgba(93, 164, 199, 0.15);
        }

        /* ==================== CALM SPACE ==================== */
        .calm-space-content {
            position: relative;
            min-height: calc(100vh - 8rem);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .calm-gradient {
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, 
                #667eea 0%, 
                #764ba2 15%,
                #f093fb 30%,
                #f5576c 45%,
                #4facfe 60%,
                #00f2fe 75%,
                #43e97b 90%,
                #667eea 100%);
            background-size: 600% 600%;
            animation: gradientShift 25s ease infinite;
            opacity: 0.4;
        }

        .calm-gradient::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse at 30% 20%, rgba(168, 139, 250, 0.3) 0%, transparent 50%),
                        radial-gradient(ellipse at 70% 80%, rgba(74, 222, 200, 0.3) 0%, transparent 50%),
                        radial-gradient(ellipse at 50% 50%, rgba(251, 191, 208, 0.2) 0%, transparent 60%);
            animation: auroraShift 15s ease-in-out infinite alternate;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 50% 100%; }
            50% { background-position: 100% 50%; }
            75% { background-position: 50% 0%; }
        }

        @keyframes auroraShift {
            0% { opacity: 0.6; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.1); }
        }

        .calm-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 8rem);
            padding: 2rem;
            text-align: center;
        }

        .breathing-container {
            margin-bottom: 3rem;
        }

        .breathing-circle {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.9) 0%, 
                rgba(230, 223, 245, 0.9) 50%,
                rgba(216, 240, 227, 0.9) 100%);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.25),
                        0 0 80px rgba(155, 127, 212, 0.15),
                        inset 0 0 30px rgba(255, 255, 255, 0.5);
            transition: transform 4s ease-in-out, box-shadow 4s ease-in-out;
            border: 2px solid rgba(255, 255, 255, 0.6);
        }

        .breathing-circle.inhale {
            transform: scale(1.35);
            box-shadow: 0 25px 80px rgba(102, 126, 234, 0.35),
                        0 0 100px rgba(155, 127, 212, 0.25),
                        inset 0 0 40px rgba(255, 255, 255, 0.6);
        }

        .breathing-circle.hold {
            transform: scale(1.35);
            box-shadow: 0 25px 80px rgba(74, 222, 200, 0.35),
                        0 0 100px rgba(95, 168, 134, 0.25),
                        inset 0 0 40px rgba(255, 255, 255, 0.6);
        }

        .breathing-circle.exhale {
            transform: scale(1);
        }

        .breathing-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.6rem;
            font-weight: 500;
            color: var(--text-primary);
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
        }

        .breathing-instruction {
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 1rem;
            font-weight: 500;
            text-shadow: 0 1px 3px rgba(255, 255, 255, 0.8);
        }

        .breathing-timer {
            font-size: 3rem;
            font-weight: 300;
            color: var(--lavender-rich);
            margin-bottom: 1.5rem;
            text-shadow: 0 2px 4px rgba(255, 255, 255, 0.5);
        }

        .calm-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
        }

        .sound-toggle {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem 1.5rem;
            background: rgba(255, 255, 255, 0.85);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .sound-toggle:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
        }

        .sound-toggle.active {
            background: linear-gradient(135deg, var(--teal-soft) 0%, var(--sage-soft) 100%);
            border-color: var(--teal);
            box-shadow: 0 4px 20px rgba(74, 179, 168, 0.3);
        }

        .sound-toggle[data-sound="rain"].active {
            background: linear-gradient(135deg, var(--sky-soft) 0%, #c3e0f0 100%);
            border-color: var(--sky);
            box-shadow: 0 4px 20px rgba(93, 164, 199, 0.3);
        }

        .sound-toggle[data-sound="forest"].active {
            background: linear-gradient(135deg, var(--sage-soft) 0%, #c8ecd7 100%);
            border-color: var(--sage);
            box-shadow: 0 4px 20px rgba(95, 168, 134, 0.3);
        }

        .sound-toggle[data-sound="waves"].active {
            background: linear-gradient(135deg, var(--teal-soft) 0%, #b8ebe6 100%);
            border-color: var(--teal);
            box-shadow: 0 4px 20px rgba(74, 179, 168, 0.3);
        }

        .sound-toggle[data-sound="music"].active {
            background: linear-gradient(135deg, var(--lavender-soft) 0%, var(--rose-soft) 100%);
            border-color: var(--lavender);
            box-shadow: 0 4px 20px rgba(155, 127, 212, 0.3);
        }

        .sound-icon {
            font-size: 1.4rem;
        }

        .sound-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: var(--transition);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .menu-toggle {
                display: block;
            }

            .main-content {
                margin-left: 0;
                padding: 1rem;
                padding-top: 4rem;
            }

            .section-title {
                font-size: 1.75rem;
            }

            .mood-calendar {
                gap: 0.25rem;
            }

            .mood-btn {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .breathing-circle {
                width: 150px;
                height: 150px;
            }

            .affirmation-text {
                font-size: 1.5rem;
            }

            .add-win-form {
                flex-direction: column;
            }
        }

        /* Overlay for mobile */
        .overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 50;
        }

        .overlay.active {
            display: block;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-accent);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--lavender);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #b3a3d1;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* ==================== DARK MODE TOGGLE ==================== */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: var(--bg-accent);
            border-radius: var(--radius-sm);
            cursor: pointer;
            margin-bottom: 1rem;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background: var(--lavender-soft);
        }

        .theme-toggle-icon {
            font-size: 1.25rem;
        }

        .theme-toggle-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* ==================== GREETING HEADER ==================== */
        .greeting-header {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--lavender-soft) 0%, var(--sky-soft) 100%);
            border-radius: var(--radius);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        [data-theme="dark"] .greeting-header {
            background: linear-gradient(135deg, rgba(155, 127, 212, 0.2) 0%, rgba(93, 164, 199, 0.2) 100%);
        }

        .greeting-text h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.75rem;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .greeting-text p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .streak-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--gold-soft);
            border-radius: 20px;
            color: var(--gold);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .streak-badge.active {
            background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
            color: #5c4a00;
            box-shadow: 0 4px 15px rgba(255, 170, 0, 0.3);
        }

        /* ==================== DAILY INTENTION ==================== */
        .intention-card {
            background: linear-gradient(135deg, var(--sage-soft) 0%, var(--teal-soft) 100%);
            border: none;
        }

        [data-theme="dark"] .intention-card {
            background: linear-gradient(135deg, rgba(95, 168, 134, 0.2) 0%, rgba(74, 179, 168, 0.2) 100%);
        }

        .intention-display {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-style: italic;
            color: var(--sage-rich);
            text-align: center;
            padding: 1rem;
        }

        [data-theme="dark"] .intention-display {
            color: var(--sage);
        }

        .intention-input-wrapper {
            display: flex;
            gap: 0.75rem;
        }

        /* ==================== MOOD NOTES ==================== */
        .mood-note-input {
            margin-top: 1rem;
            display: none;
        }

        .mood-note-input.visible {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .mood-note-textarea {
            min-height: 80px;
            margin-bottom: 0.75rem;
        }

        /* ==================== SEARCH BAR ==================== */
        .search-bar {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-bar input {
            padding-left: 2.5rem;
        }

        .search-bar-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }

        /* ==================== GRATITUDE PROMPTS ==================== */
        .prompts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .prompt-chip {
            padding: 0.4rem 0.875rem;
            background: var(--bg-accent);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .prompt-chip:hover {
            background: var(--lavender-soft);
            border-color: var(--lavender);
            color: var(--lavender-rich);
        }

        /* ==================== STATS DASHBOARD ==================== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--bg-accent);
            border-radius: var(--radius-sm);
            padding: 1.25rem;
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-soft);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--lavender-rich);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-card.sage .stat-value { color: var(--sage-rich); }
        .stat-card.sky .stat-value { color: var(--sky-rich); }
        .stat-card.gold .stat-value { color: var(--gold); }
        .stat-card.rose .stat-value { color: var(--rose); }

        /* ==================== BREATHING PATTERNS ==================== */
        .breathing-patterns {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        .pattern-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid transparent;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }

        .pattern-btn:hover {
            background: rgba(255, 255, 255, 0.9);
        }

        .pattern-btn.active {
            background: var(--lavender-soft);
            border-color: var(--lavender);
            color: var(--lavender-rich);
        }

        /* ==================== MEDITATION TIMER ==================== */
        .meditation-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        .meditation-times {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .meditation-time-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.7);
            border: none;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }

        .meditation-time-btn.active {
            background: var(--sage-soft);
            color: var(--sage-rich);
        }

        .meditation-display {
            font-size: 3rem;
            font-weight: 300;
            color: var(--text-primary);
            text-align: center;
            margin: 1rem 0;
            text-shadow: 0 2px 4px rgba(255, 255, 255, 0.5);
        }

        /* ==================== CUSTOM AFFIRMATIONS ==================== */
        .custom-affirmations {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }

        .affirmation-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .affirmation-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background: var(--bg-accent);
            border-radius: var(--radius-sm);
            margin-bottom: 0.5rem;
        }

        .affirmation-item-text {
            flex: 1;
            color: var(--text-secondary);
            font-style: italic;
        }

        .affirmation-item-delete {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            opacity: 0;
            transition: var(--transition);
        }

        .affirmation-item:hover .affirmation-item-delete {
            opacity: 1;
        }

        /* ==================== WEEKLY REFLECTION ==================== */
        .reflection-prompt {
            background: linear-gradient(135deg, var(--lavender-soft) 0%, var(--rose-soft) 100%);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        [data-theme="dark"] .reflection-prompt {
            background: linear-gradient(135deg, rgba(155, 127, 212, 0.2) 0%, rgba(214, 122, 143, 0.2) 100%);
        }

        .reflection-question {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.25rem;
            font-style: italic;
            color: var(--lavender-rich);
            margin-bottom: 1rem;
        }

        [data-theme="dark"] .reflection-question {
            color: var(--lavender);
        }

        /* ==================== ONBOARDING MODAL ==================== */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            max-width: 500px;
            width: 100%;
            padding: 2.5rem;
            text-align: center;
            animation: modalIn 0.4s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .modal-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .modal-text {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.7;
        }

        /* ==================== CONFETTI ==================== */
        .confetti-container {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confettiFall 3s ease-out forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        /* ==================== EXPORT BUTTON ==================== */
        .export-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-accent);
            border: none;
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .export-btn:hover {
            background: var(--lavender-soft);
            color: var(--lavender-rich);
        }

        /* ==================== KEYBOARD SHORTCUTS HINT ==================== */
        .shortcuts-hint {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-soft);
            font-size: 0.75rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            z-index: 50;
        }

        .kbd {
            padding: 0.2rem 0.4rem;
            background: var(--bg-accent);
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.7rem;
        }

        @media (max-width: 768px) {
            .shortcuts-hint { display: none; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .greeting-header { flex-direction: column; text-align: center; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Mobile Menu Toggle -->
        <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
        
        <!-- Overlay for mobile -->
        <div class="overlay" onclick="toggleSidebar()"></div>

        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <h1 class="logo">Serenity</h1>
            <p class="logo-subtitle">Wellness Dashboard</p>
            
            <div class="theme-toggle" onclick="toggleTheme()">
                <span class="theme-toggle-icon" id="themeIcon">üåô</span>
                <span class="theme-toggle-label" id="themeLabel">Dark Mode</span>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link active" data-section="home">
                        <span class="nav-icon">üè†</span>
                        Home
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="gratitude">
                        <span class="nav-icon">üìù</span>
                        Gratitude Journal
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="mood">
                        <span class="nav-icon">üåà</span>
                        Mood Tracker
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="affirmations">
                        <span class="nav-icon">‚ú®</span>
                        Daily Affirmations
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="wins">
                        <span class="nav-icon">üèÜ</span>
                        Tiny Wins
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-section="calm">
                        <span class="nav-icon">üåø</span>
                        Calm Space
                    </a>
                </li>
            </ul>

            <div class="current-date">
                <p class="current-date-day" id="currentDay"></p>
                <p class="current-date-full" id="currentDate"></p>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Section -->
            <section id="home" class="section active">
                <div class="greeting-header">
                    <div class="greeting-text">
                        <h2 id="greetingText">Good morning!</h2>
                        <p>Let's make today meaningful.</p>
                    </div>
                    <div class="streak-badge" id="streakBadge">
                        üî• <span id="streakCount">0</span> day streak
                    </div>
                </div>

                <div class="card intention-card">
                    <p class="card-title">Today's Intention</p>
                    <div id="intentionDisplay" class="intention-display" style="display: none;"></div>
                    <div id="intentionForm">
                        <div class="intention-input-wrapper">
                            <input type="text" id="intentionInput" placeholder="What's your focus for today?">
                            <button class="btn btn-primary" onclick="saveIntention()">Set</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <p class="card-title">Your Wellness Stats</p>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="statGratitude">0</div>
                            <div class="stat-label">Gratitude Entries</div>
                        </div>
                        <div class="stat-card sage">
                            <div class="stat-value" id="statMoods">0</div>
                            <div class="stat-label">Moods Logged</div>
                        </div>
                        <div class="stat-card sky">
                            <div class="stat-value" id="statWins">0</div>
                            <div class="stat-label">Wins Completed</div>
                        </div>
                        <div class="stat-card gold">
                            <div class="stat-value" id="statStreak">0</div>
                            <div class="stat-label">Day Streak</div>
                        </div>
                    </div>
                </div>

                <div class="card reflection-prompt" id="weeklyReflection" style="display: none;">
                    <p class="card-title">Weekly Reflection</p>
                    <p class="reflection-question" id="reflectionQuestion"></p>
                    <textarea id="reflectionInput" placeholder="Take a moment to reflect..."></textarea>
                    <button class="btn btn-primary" onclick="saveReflection()" style="margin-top: 1rem;">Save Reflection</button>
                </div>
            </section>

            <!-- Gratitude Journal Section -->
            <section id="gratitude" class="section">
                <div class="section-header">
                    <h2 class="section-title">Gratitude Journal</h2>
                    <p class="section-subtitle">Take a moment to appreciate the little things</p>
                </div>

                <div class="card">
                    <p class="card-title">What are you grateful for today?</p>
                    <div class="prompts-container">
                        <span class="prompt-chip" onclick="usePrompt('Someone who made me smile today...')">Someone who made me smile</span>
                        <span class="prompt-chip" onclick="usePrompt('A small comfort I enjoyed...')">A small comfort</span>
                        <span class="prompt-chip" onclick="usePrompt('Something I\'m looking forward to...')">Looking forward to</span>
                        <span class="prompt-chip" onclick="usePrompt('A lesson I learned recently...')">A lesson learned</span>
                        <span class="prompt-chip" onclick="usePrompt('Something beautiful I noticed...')">Something beautiful</span>
                    </div>
                    <textarea class="gratitude-input" id="gratitudeInput" placeholder="Today I'm grateful for..."></textarea>
                    <div style="display: flex; gap: 0.75rem; align-items: center; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="saveGratitude()">Save Entry</button>
                        <button class="export-btn" onclick="exportGratitude()">üì• Export Journal</button>
                    </div>
                </div>

                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem;">
                        <p class="card-title" style="margin: 0;">Past Reflections</p>
                    </div>
                    <div class="search-bar">
                        <span class="search-bar-icon">üîç</span>
                        <input type="text" id="gratitudeSearch" placeholder="Search entries..." oninput="filterGratitude()">
                    </div>
                    <div class="gratitude-entries" id="gratitudeEntries">
                        <!-- Entries will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Mood Tracker Section -->
            <section id="mood" class="section">
                <div class="section-header">
                    <h2 class="section-title">Mood Tracker</h2>
                    <p class="section-subtitle">How are you feeling today?</p>
                </div>

                <div class="card">
                    <p class="card-title">Select Your Mood</p>
                    <div class="mood-selector">
                        <button class="mood-btn" data-mood="amazing" title="Amazing">üåü</button>
                        <button class="mood-btn" data-mood="good" title="Good">üòä</button>
                        <button class="mood-btn" data-mood="okay" title="Okay">üòê</button>
                        <button class="mood-btn" data-mood="low" title="Low">üòî</button>
                        <button class="mood-btn" data-mood="rough" title="Rough">üò¢</button>
                    </div>
                    <div class="mood-note-input" id="moodNoteInput">
                        <textarea class="mood-note-textarea" id="moodNoteText" placeholder="What's on your mind? (optional)"></textarea>
                        <button class="btn btn-secondary" onclick="saveMoodNote()">Add Note</button>
                    </div>
                </div>

                <div class="card">
                    <div class="mood-month-nav">
                        <button class="btn btn-soft" onclick="changeMonth(-1)">‚Üê Previous</button>
                        <h3 class="mood-month-title" id="moodMonthTitle"></h3>
                        <button class="btn btn-soft" onclick="changeMonth(1)">Next ‚Üí</button>
                    </div>
                    <div class="mood-calendar" id="moodCalendar">
                        <!-- Calendar will be generated here -->
                    </div>
                </div>
            </section>

            <!-- Daily Affirmations Section -->
            <section id="affirmations" class="section">
                <div class="section-header">
                    <h2 class="section-title">Daily Affirmations</h2>
                    <p class="section-subtitle">Words to lift your spirit</p>
                </div>

                <div class="card affirmation-container">
                    <div class="affirmation-decoration">üå∏</div>
                    <p class="affirmation-text" id="affirmationText"></p>
                    <button class="btn btn-primary" onclick="newAffirmation()">
                        ‚ú® New Affirmation
                    </button>
                </div>

                <div class="card">
                    <p class="card-title">Add Your Own Affirmations</p>
                    <div class="intention-input-wrapper" style="margin-bottom: 1rem;">
                        <input type="text" id="customAffirmationInput" placeholder="Write your personal affirmation...">
                        <button class="btn btn-primary" onclick="addCustomAffirmation()">Add</button>
                    </div>
                    <div class="affirmation-list" id="customAffirmationsList">
                        <!-- Custom affirmations will appear here -->
                    </div>
                </div>
            </section>

            <!-- Tiny Wins Section -->
            <section id="wins" class="section">
                <div class="section-header">
                    <h2 class="section-title">Tiny Wins</h2>
                    <p class="section-subtitle">Celebrate your small victories</p>
                </div>

                <div class="card wins-today">
                    <p class="card-title">Today's Checklist</p>
                    <div class="add-win-form">
                        <input type="text" class="add-win-input" id="newWinInput" placeholder="Add a new tiny win...">
                        <button class="btn btn-primary" onclick="addWin()">Add</button>
                    </div>
                    <div id="winsList">
                        <!-- Wins will be loaded here -->
                    </div>
                </div>

                <div class="card">
                    <p class="card-title">Past Victories</p>
                    <div class="wins-history" id="winsHistory">
                        <!-- History will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Calm Space Section -->
            <section id="calm" class="section">
                <div class="section-header">
                    <h2 class="section-title">Calm Space</h2>
                    <p class="section-subtitle">A peaceful moment just for you</p>
                </div>

                <div class="calm-space-content">
                    <div class="calm-gradient"></div>
                    <div class="calm-content">
                        <div class="breathing-container">
                            <p class="card-title" style="color: var(--text-primary); margin-bottom: 1rem;">Breathing Pattern</p>
                            <div class="breathing-patterns">
                                <button class="pattern-btn active" data-pattern="relaxing" onclick="setBreathingPattern('relaxing')">Relaxing (4-4-4)</button>
                                <button class="pattern-btn" data-pattern="calming" onclick="setBreathingPattern('calming')">4-7-8 Calm</button>
                                <button class="pattern-btn" data-pattern="energizing" onclick="setBreathingPattern('energizing')">Energizing</button>
                                <button class="pattern-btn" data-pattern="box" onclick="setBreathingPattern('box')">Box (4-4-4-4)</button>
                            </div>
                            
                            <div class="breathing-circle" id="breathingCircle">
                                <span class="breathing-text" id="breathingText">Ready</span>
                            </div>
                            <p class="breathing-instruction" id="breathingInstruction">Press start to begin the breathing exercise</p>
                            <p class="breathing-timer" id="breathingTimer">4</p>
                            <button class="btn btn-primary" id="breathingBtn" onclick="toggleBreathing()">
                                Start Breathing Exercise
                            </button>
                        </div>

                        <div class="calm-controls">
                            <div class="sound-toggle" data-sound="rain" onclick="toggleSound('rain')">
                                <span class="sound-icon">üåßÔ∏è</span>
                                <span class="sound-label">Rain Sounds</span>
                            </div>
                            <div class="sound-toggle" data-sound="forest" onclick="toggleSound('forest')">
                                <span class="sound-icon">üå≤</span>
                                <span class="sound-label">Forest</span>
                            </div>
                            <div class="sound-toggle" data-sound="waves" onclick="toggleSound('waves')">
                                <span class="sound-icon">üåä</span>
                                <span class="sound-label">Ocean Waves</span>
                            </div>
                            <div class="sound-toggle" data-sound="music" onclick="toggleSound('music')">
                                <span class="sound-icon">üéµ</span>
                                <span class="sound-label">Calm Music</span>
                            </div>
                        </div>

                        <div class="meditation-section">
                            <p class="card-title" style="color: var(--text-primary); margin-bottom: 1rem; text-align: center;">Meditation Timer</p>
                            <div class="meditation-times">
                                <button class="meditation-time-btn active" data-minutes="3" onclick="setMeditationTime(3)">3 min</button>
                                <button class="meditation-time-btn" data-minutes="5" onclick="setMeditationTime(5)">5 min</button>
                                <button class="meditation-time-btn" data-minutes="10" onclick="setMeditationTime(10)">10 min</button>
                                <button class="meditation-time-btn" data-minutes="15" onclick="setMeditationTime(15)">15 min</button>
                            </div>
                            <p class="meditation-display" id="meditationDisplay">3:00</p>
                            <button class="btn btn-primary" id="meditationBtn" onclick="toggleMeditation()">
                                Start Meditation
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Onboarding Modal -->
    <div class="modal-overlay" id="onboardingModal">
        <div class="modal">
            <div class="modal-icon">üåø</div>
            <h2 class="modal-title">Welcome to Serenity</h2>
            <p class="modal-text">
                Your personal wellness dashboard for practicing gratitude, tracking moods, and finding moments of calm. 
                Everything is saved locally on your device‚Äîyour space, your pace.
            </p>
            <button class="btn btn-primary" onclick="closeOnboarding()">Begin Your Journey</button>
        </div>
    </div>

    <!-- Confetti Container -->
    <div class="confetti-container" id="confettiContainer"></div>

    <!-- Keyboard Shortcuts Hint -->
    <div class="shortcuts-hint">
        <span class="kbd">?</span> Keyboard shortcuts
    </div>

    <!-- Audio elements for ambient sounds -->
    <audio id="rainSound" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/05/13/audio_257112181d.mp3" type="audio/mpeg">
    </audio>
    <audio id="forestSound" loop>
        <source src="https://cdn.pixabay.com/download/audio/2021/09/06/audio_d0c0e79e40.mp3" type="audio/mpeg">
    </audio>
    <audio id="wavesSound" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/02/23/audio_ea70ad08e3.mp3" type="audio/mpeg">
    </audio>
    <audio id="musicSound" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3" type="audio/mpeg">
    </audio>

    <script>
        // ==================== STATE MANAGEMENT ====================
        const state = {
            currentSection: 'home',
            moodViewDate: new Date(),
            breathingActive: false,
            breathingInterval: null,
            currentSound: null,
            breathingPattern: 'relaxing',
            meditationMinutes: 3,
            meditationActive: false,
            meditationInterval: null,
            meditationSeconds: 180
        };

        // ==================== BREATHING PATTERNS ====================
        const breathingPatterns = {
            relaxing: [
                { name: 'Inhale', duration: 4, class: 'inhale' },
                { name: 'Hold', duration: 4, class: 'hold' },
                { name: 'Exhale', duration: 4, class: 'exhale' }
            ],
            calming: [
                { name: 'Inhale', duration: 4, class: 'inhale' },
                { name: 'Hold', duration: 7, class: 'hold' },
                { name: 'Exhale', duration: 8, class: 'exhale' }
            ],
            energizing: [
                { name: 'Inhale', duration: 2, class: 'inhale' },
                { name: 'Exhale', duration: 2, class: 'exhale' }
            ],
            box: [
                { name: 'Inhale', duration: 4, class: 'inhale' },
                { name: 'Hold', duration: 4, class: 'hold' },
                { name: 'Exhale', duration: 4, class: 'exhale' },
                { name: 'Hold', duration: 4, class: 'hold' }
            ]
        };

        // ==================== WEEKLY REFLECTION QUESTIONS ====================
        const reflectionQuestions = [
            "What brought you the most joy this week?",
            "What's one thing you learned about yourself?",
            "What are you most proud of accomplishing?",
            "Who made a positive impact on your week?",
            "What would you do differently next week?",
            "What are you grateful for from this past week?",
            "What moment would you like to relive?"
        ];

        // ==================== AFFIRMATIONS DATA ====================
        const affirmations = [
            "You are worthy of love and kindness, especially from yourself.",
            "Today is full of possibilities. Embrace them gently.",
            "Your feelings are valid. It's okay to feel what you feel.",
            "You are enough, exactly as you are right now.",
            "Small steps still move you forward. Be proud of every one.",
            "You deserve rest and peace. Give yourself permission to pause.",
            "Your presence makes the world a little brighter.",
            "It's okay to ask for help. Strength comes in many forms.",
            "You are growing, even when you can't see it.",
            "Today, choose kindness‚Äîfor others and for yourself.",
            "You have overcome challenges before. You can do it again.",
            "Your journey is unique. Comparison steals your joy.",
            "Breathe deeply. This moment is all you need to focus on.",
            "You bring something special to every room you enter.",
            "Progress, not perfection. Every effort counts.",
            "Your heart knows what it needs. Trust yourself.",
            "You are resilient, even on the hard days.",
            "The world needs your light. Don't dim it for anyone.",
            "It's okay to take things one moment at a time.",
            "You are doing better than you think. Keep going.",
            "Your peace matters. Protect it gently.",
            "Every new day is a chance to begin again.",
            "You are not your mistakes. You are your growth.",
            "Happiness looks different for everyone. Define your own.",
            "You deserve to take up space in this world."
        ];

        // ==================== DEFAULT WINS ====================
        const defaultWins = [
            "Drank a glass of water üíß",
            "Went outside for fresh air üåø",
            "Got dressed today üëï",
            "Made my bed üõèÔ∏è",
            "Ate a meal üçΩÔ∏è",
            "Took a deep breath üå¨Ô∏è",
            "Said something kind to myself üíú"
        ];

        // ==================== UTILITY FUNCTIONS ====================
        function getToday() {
            return new Date().toISOString().split('T')[0];
        }

        function formatDate(date) {
            return new Date(date).toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function formatTime(date) {
            return new Date(date).toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit'
            });
        }

        // ==================== THEME TOGGLE ====================
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeUI(newTheme);
        }

        function updateThemeUI(theme) {
            const icon = document.getElementById('themeIcon');
            const label = document.getElementById('themeLabel');
            
            if (theme === 'dark') {
                icon.textContent = '‚òÄÔ∏è';
                label.textContent = 'Light Mode';
            } else {
                icon.textContent = 'üåô';
                label.textContent = 'Dark Mode';
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeUI(savedTheme);
        }

        // ==================== GREETING ====================
        function updateGreeting() {
            const hour = new Date().getHours();
            const greetingEl = document.getElementById('greetingText');
            let greeting = 'Good evening!';
            
            if (hour < 12) greeting = 'Good morning!';
            else if (hour < 17) greeting = 'Good afternoon!';
            
            greetingEl.textContent = greeting;
        }

        // ==================== STREAK TRACKER ====================
        function calculateStreak() {
            const entries = JSON.parse(localStorage.getItem('gratitudeEntries') || '[]');
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');
            
            // Get all unique dates with activity
            const activityDates = new Set();
            entries.forEach(e => activityDates.add(e.date.split('T')[0]));
            Object.keys(moods).forEach(d => activityDates.add(d));
            
            // Calculate streak from today backwards
            let streak = 0;
            let checkDate = new Date();
            
            while (true) {
                const dateStr = checkDate.toISOString().split('T')[0];
                if (activityDates.has(dateStr)) {
                    streak++;
                    checkDate.setDate(checkDate.getDate() - 1);
                } else if (streak === 0) {
                    // Check if today just hasn't had activity yet
                    checkDate.setDate(checkDate.getDate() - 1);
                    continue;
                } else {
                    break;
                }
                if (streak > 365) break; // Safety limit
            }
            
            return streak;
        }

        function updateStreak() {
            const streak = calculateStreak();
            document.getElementById('streakCount').textContent = streak;
            document.getElementById('statStreak').textContent = streak;
            
            const badge = document.getElementById('streakBadge');
            if (streak >= 7) {
                badge.classList.add('active');
            } else {
                badge.classList.remove('active');
            }
            
            // Confetti for milestone streaks
            if (streak > 0 && streak % 7 === 0) {
                const lastCelebrated = localStorage.getItem('lastStreakCelebration');
                if (lastCelebrated !== streak.toString()) {
                    triggerConfetti();
                    localStorage.setItem('lastStreakCelebration', streak.toString());
                }
            }
        }

        // ==================== STATS ====================
        function updateStats() {
            const entries = JSON.parse(localStorage.getItem('gratitudeEntries') || '[]');
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');
            const winsData = JSON.parse(localStorage.getItem('winsData') || '{}');
            
            document.getElementById('statGratitude').textContent = entries.length;
            document.getElementById('statMoods').textContent = Object.keys(moods).length;
            
            // Count completed wins
            let totalWins = 0;
            if (winsData.history) {
                winsData.history.forEach(day => totalWins += day.wins.length);
            }
            if (winsData.todayWins) {
                totalWins += winsData.todayWins.filter(w => w.completed).length;
            }
            document.getElementById('statWins').textContent = totalWins;
        }

        // ==================== DAILY INTENTION ====================
        function loadIntention() {
            const today = getToday();
            const intentions = JSON.parse(localStorage.getItem('intentions') || '{}');
            
            if (intentions[today]) {
                document.getElementById('intentionDisplay').textContent = `"${intentions[today]}"`;
                document.getElementById('intentionDisplay').style.display = 'block';
                document.getElementById('intentionForm').style.display = 'none';
            } else {
                document.getElementById('intentionDisplay').style.display = 'none';
                document.getElementById('intentionForm').style.display = 'block';
            }
        }

        function saveIntention() {
            const input = document.getElementById('intentionInput');
            const text = input.value.trim();
            if (!text) return;
            
            const today = getToday();
            const intentions = JSON.parse(localStorage.getItem('intentions') || '{}');
            intentions[today] = text;
            localStorage.setItem('intentions', JSON.stringify(intentions));
            
            input.value = '';
            loadIntention();
        }

        // ==================== WEEKLY REFLECTION ====================
        function checkWeeklyReflection() {
            const today = new Date();
            if (today.getDay() === 0) { // Sunday
                const lastReflection = localStorage.getItem('lastReflection');
                const thisWeek = getToday();
                
                if (lastReflection !== thisWeek) {
                    const question = reflectionQuestions[Math.floor(Math.random() * reflectionQuestions.length)];
                    document.getElementById('reflectionQuestion').textContent = question;
                    document.getElementById('weeklyReflection').style.display = 'block';
                }
            }
        }

        function saveReflection() {
            const input = document.getElementById('reflectionInput');
            const text = input.value.trim();
            if (!text) return;
            
            const reflections = JSON.parse(localStorage.getItem('reflections') || '[]');
            reflections.unshift({
                date: new Date().toISOString(),
                question: document.getElementById('reflectionQuestion').textContent,
                answer: text
            });
            localStorage.setItem('reflections', JSON.stringify(reflections));
            localStorage.setItem('lastReflection', getToday());
            
            input.value = '';
            document.getElementById('weeklyReflection').style.display = 'none';
        }

        // ==================== GRATITUDE PROMPTS ====================
        function usePrompt(prompt) {
            document.getElementById('gratitudeInput').value = prompt;
            document.getElementById('gratitudeInput').focus();
        }

        // ==================== GRATITUDE SEARCH ====================
        function filterGratitude() {
            const search = document.getElementById('gratitudeSearch').value.toLowerCase();
            const entries = JSON.parse(localStorage.getItem('gratitudeEntries') || '[]');
            const filtered = search ? entries.filter(e => e.text.toLowerCase().includes(search)) : entries;
            renderGratitudeEntries(filtered);
        }

        function renderGratitudeEntries(entries) {
            const container = document.getElementById('gratitudeEntries');
            
            if (entries.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <p>No entries found.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = entries.map(entry => `
                <div class="gratitude-entry">
                    <p class="gratitude-entry-date">${formatDate(entry.date)} at ${formatTime(entry.date)}</p>
                    <p class="gratitude-entry-text">${entry.text}</p>
                </div>
            `).join('');
        }

        // ==================== EXPORT GRATITUDE ====================
        function exportGratitude() {
            const entries = JSON.parse(localStorage.getItem('gratitudeEntries') || '[]');
            if (entries.length === 0) {
                alert('No entries to export yet!');
                return;
            }
            
            let text = "üåø My Gratitude Journal\n";
            text += "========================\n\n";
            
            entries.forEach(entry => {
                text += `${formatDate(entry.date)} at ${formatTime(entry.date)}\n`;
                text += `${entry.text}\n\n`;
                text += "---\n\n";
            });
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'gratitude-journal.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // ==================== CUSTOM AFFIRMATIONS ====================
        function loadCustomAffirmations() {
            const custom = JSON.parse(localStorage.getItem('customAffirmations') || '[]');
            const container = document.getElementById('customAffirmationsList');
            
            if (custom.length === 0) {
                container.innerHTML = '<p style="color: var(--text-muted); text-align: center; padding: 1rem;">Add your personal affirmations above!</p>';
                return;
            }
            
            container.innerHTML = custom.map((aff, i) => `
                <div class="affirmation-item">
                    <span class="affirmation-item-text">"${aff}"</span>
                    <button class="affirmation-item-delete" onclick="deleteCustomAffirmation(${i})">√ó</button>
                </div>
            `).join('');
        }

        function addCustomAffirmation() {
            const input = document.getElementById('customAffirmationInput');
            const text = input.value.trim();
            if (!text) return;
            
            const custom = JSON.parse(localStorage.getItem('customAffirmations') || '[]');
            custom.push(text);
            localStorage.setItem('customAffirmations', JSON.stringify(custom));
            
            input.value = '';
            loadCustomAffirmations();
        }

        function deleteCustomAffirmation(index) {
            const custom = JSON.parse(localStorage.getItem('customAffirmations') || '[]');
            custom.splice(index, 1);
            localStorage.setItem('customAffirmations', JSON.stringify(custom));
            loadCustomAffirmations();
        }

        function getAllAffirmations() {
            const custom = JSON.parse(localStorage.getItem('customAffirmations') || '[]');
            return [...affirmations, ...custom];
        }

        // ==================== MOOD NOTES ====================
        function showMoodNote() {
            document.getElementById('moodNoteInput').classList.add('visible');
        }

        function saveMoodNote() {
            const text = document.getElementById('moodNoteText').value.trim();
            if (!text) return;
            
            const today = getToday();
            const moodNotes = JSON.parse(localStorage.getItem('moodNotes') || '{}');
            moodNotes[today] = text;
            localStorage.setItem('moodNotes', JSON.stringify(moodNotes));
            
            document.getElementById('moodNoteText').value = '';
            document.getElementById('moodNoteInput').classList.remove('visible');
        }

        // ==================== BREATHING PATTERNS ====================
        function setBreathingPattern(pattern) {
            state.breathingPattern = pattern;
            document.querySelectorAll('.pattern-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.pattern === pattern);
            });
            
            if (state.breathingActive) {
                stopBreathing();
                startBreathing();
            }
        }

        // ==================== MEDITATION TIMER ====================
        function setMeditationTime(minutes) {
            state.meditationMinutes = minutes;
            state.meditationSeconds = minutes * 60;
            updateMeditationDisplay();
            
            document.querySelectorAll('.meditation-time-btn').forEach(btn => {
                btn.classList.toggle('active', parseInt(btn.dataset.minutes) === minutes);
            });
        }

        function updateMeditationDisplay() {
            const mins = Math.floor(state.meditationSeconds / 60);
            const secs = state.meditationSeconds % 60;
            document.getElementById('meditationDisplay').textContent = 
                `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function toggleMeditation() {
            if (state.meditationActive) {
                stopMeditation();
            } else {
                startMeditation();
            }
        }

        function startMeditation() {
            state.meditationActive = true;
            document.getElementById('meditationBtn').textContent = 'Stop Meditation';
            
            state.meditationInterval = setInterval(() => {
                state.meditationSeconds--;
                updateMeditationDisplay();
                
                if (state.meditationSeconds <= 0) {
                    stopMeditation();
                    // Play a gentle bell sound or notification
                    triggerConfetti();
                }
            }, 1000);
        }

        function stopMeditation() {
            state.meditationActive = false;
            clearInterval(state.meditationInterval);
            document.getElementById('meditationBtn').textContent = 'Start Meditation';
            state.meditationSeconds = state.meditationMinutes * 60;
            updateMeditationDisplay();
        }

        // ==================== ONBOARDING ====================
        function checkOnboarding() {
            const hasVisited = localStorage.getItem('hasVisited');
            if (!hasVisited) {
                document.getElementById('onboardingModal').classList.add('active');
            }
        }

        function closeOnboarding() {
            localStorage.setItem('hasVisited', 'true');
            document.getElementById('onboardingModal').classList.remove('active');
        }

        // ==================== CONFETTI ====================
        function triggerConfetti() {
            const container = document.getElementById('confettiContainer');
            const colors = ['#9b7fd4', '#5fa886', '#5da4c7', '#e89b7b', '#d67a8f', '#d4a85a', '#4ab3a8'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                container.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 3500);
            }
        }

        // ==================== KEYBOARD SHORTCUTS ====================
        function initKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ignore if typing in input
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
                
                switch(e.key) {
                    case '1': switchSection('home'); break;
                    case '2': switchSection('gratitude'); break;
                    case '3': switchSection('mood'); break;
                    case '4': switchSection('affirmations'); break;
                    case '5': switchSection('wins'); break;
                    case '6': switchSection('calm'); break;
                    case 'd': toggleTheme(); break;
                    case '?':
                        alert('Keyboard Shortcuts:\n\n1 - Home\n2 - Gratitude\n3 - Mood\n4 - Affirmations\n5 - Wins\n6 - Calm Space\nD - Toggle Dark Mode');
                        break;
                }
            });
        }

        // ==================== NAVIGATION ====================
        function initNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    const section = link.dataset.section;
                    switchSection(section);
                    
                    // Close mobile menu
                    document.querySelector('.sidebar').classList.remove('open');
                    document.querySelector('.overlay').classList.remove('active');
                });
            });
        }

        function switchSection(sectionId) {
            // Update nav
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.toggle('active', link.dataset.section === sectionId);
            });

            // Update sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.toggle('active', section.id === sectionId);
            });

            state.currentSection = sectionId;
        }

        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('open');
            document.querySelector('.overlay').classList.toggle('active');
        }

        // ==================== DATE DISPLAY ====================
        function updateDateDisplay() {
            const now = new Date();
            document.getElementById('currentDay').textContent = now.toLocaleDateString('en-US', { weekday: 'long' });
            document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', { 
                month: 'long', 
                day: 'numeric', 
                year: 'numeric' 
            });
        }

        // ==================== GRATITUDE JOURNAL ====================
        function loadGratitudeEntries() {
            const entries = JSON.parse(localStorage.getItem('gratitudeEntries') || '[]');
            renderGratitudeEntries(entries);
        }

        function saveGratitude() {
            const input = document.getElementById('gratitudeInput');
            const text = input.value.trim();

            if (!text) return;

            const entries = JSON.parse(localStorage.getItem('gratitudeEntries') || '[]');
            entries.unshift({
                id: Date.now(),
                date: new Date().toISOString(),
                text: text
            });

            localStorage.setItem('gratitudeEntries', JSON.stringify(entries));
            input.value = '';
            loadGratitudeEntries();
            updateStreak();
            updateStats();
            celebrate();
        }

        // ==================== MOOD TRACKER ====================
        function initMoodTracker() {
            const moodBtns = document.querySelectorAll('.mood-btn');
            const today = getToday();
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');

            // Check if today has a mood
            if (moods[today]) {
                const selectedBtn = document.querySelector(`.mood-btn[data-mood="${moods[today]}"]`);
                if (selectedBtn) selectedBtn.classList.add('selected');
            }

            moodBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const mood = btn.dataset.mood;
                    saveMood(mood);

                    // Update UI
                    moodBtns.forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                });
            });

            renderMoodCalendar();
        }

        function saveMood(mood) {
            const today = getToday();
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');
            moods[today] = mood;
            localStorage.setItem('moods', JSON.stringify(moods));
            renderMoodCalendar();
            showMoodNote();
            updateStreak();
            updateStats();
        }

        function renderMoodCalendar() {
            const calendar = document.getElementById('moodCalendar');
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');
            const viewDate = state.moodViewDate;
            const today = getToday();

            const moodEmojis = {
                amazing: 'üåü',
                good: 'üòä',
                okay: 'üòê',
                low: 'üòî',
                rough: 'üò¢'
            };

            // Update month title
            document.getElementById('moodMonthTitle').textContent = viewDate.toLocaleDateString('en-US', {
                month: 'long',
                year: 'numeric'
            });

            const year = viewDate.getFullYear();
            const month = viewDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            let html = days.map(d => `<div class="mood-calendar-header">${d}</div>`).join('');

            // Empty cells for days before start
            for (let i = 0; i < firstDay; i++) {
                html += '<div class="mood-day empty"></div>';
            }

            // Days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const mood = moods[dateStr];
                const isToday = dateStr === today;

                html += `
                    <div class="mood-day ${isToday ? 'today' : ''}">
                        <span class="mood-day-number">${day}</span>
                        <span class="mood-day-emoji">${mood ? moodEmojis[mood] : ''}</span>
                    </div>
                `;
            }

            calendar.innerHTML = html;
        }

        function changeMonth(delta) {
            state.moodViewDate.setMonth(state.moodViewDate.getMonth() + delta);
            renderMoodCalendar();
        }

        // ==================== DAILY AFFIRMATIONS ====================
        function newAffirmation() {
            const text = document.getElementById('affirmationText');
            const allAffirmations = getAllAffirmations();
            const randomIndex = Math.floor(Math.random() * allAffirmations.length);
            text.textContent = `"${allAffirmations[randomIndex]}"`;
            text.style.opacity = 0;
            setTimeout(() => {
                text.style.transition = 'opacity 0.5s ease';
                text.style.opacity = 1;
            }, 50);
        }

        // ==================== TINY WINS ====================
        function initWins() {
            const today = getToday();
            const winsData = JSON.parse(localStorage.getItem('winsData') || '{}');

            // Check if it's a new day
            if (!winsData.currentDate || winsData.currentDate !== today) {
                // Archive yesterday's wins if they exist
                if (winsData.currentDate && winsData.todayWins) {
                    const completedWins = winsData.todayWins.filter(w => w.completed).map(w => w.text);
                    if (completedWins.length > 0) {
                        if (!winsData.history) winsData.history = [];
                        winsData.history.unshift({
                            date: winsData.currentDate,
                            wins: completedWins
                        });
                        // Keep only last 30 days
                        winsData.history = winsData.history.slice(0, 30);
                    }
                }

                // Reset for new day
                winsData.currentDate = today;
                winsData.todayWins = defaultWins.map((text, i) => ({
                    id: i,
                    text,
                    completed: false
                }));
                localStorage.setItem('winsData', JSON.stringify(winsData));
            }

            renderWins();
            renderWinsHistory();
        }

        function renderWins() {
            const winsData = JSON.parse(localStorage.getItem('winsData') || '{}');
            const container = document.getElementById('winsList');

            if (!winsData.todayWins || winsData.todayWins.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>Add some tiny wins to track!</p></div>';
                return;
            }

            container.innerHTML = winsData.todayWins.map(win => `
                <div class="win-item ${win.completed ? 'completed' : ''}" data-id="${win.id}">
                    <div class="win-checkbox ${win.completed ? 'checked' : ''}" onclick="toggleWin(${win.id})"></div>
                    <span class="win-label">${win.text}</span>
                    <button class="win-delete" onclick="deleteWin(${win.id})">√ó</button>
                </div>
            `).join('');
        }

        function toggleWin(id) {
            const winsData = JSON.parse(localStorage.getItem('winsData') || '{}');
            const win = winsData.todayWins.find(w => w.id === id);

            if (win) {
                win.completed = !win.completed;
                localStorage.setItem('winsData', JSON.stringify(winsData));
                renderWins();
                updateStats();

                // Celebration animation
                if (win.completed) {
                    celebrate();
                    
                    // Check if all wins completed
                    const allCompleted = winsData.todayWins.every(w => w.completed);
                    if (allCompleted && winsData.todayWins.length > 0) {
                        setTimeout(() => triggerConfetti(), 500);
                    }
                }
            }
        }

        function celebrate() {
            const celebrations = ['üéâ', '‚≠ê', '‚ú®', 'üåü', 'üí´', 'üéä', 'üíú', 'üå∏'];
            const emoji = celebrations[Math.floor(Math.random() * celebrations.length)];

            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            celebration.textContent = emoji;
            document.body.appendChild(celebration);

            setTimeout(() => celebration.remove(), 800);
        }

        function addWin() {
            const input = document.getElementById('newWinInput');
            const text = input.value.trim();

            if (!text) return;

            const winsData = JSON.parse(localStorage.getItem('winsData') || '{}');
            if (!winsData.todayWins) winsData.todayWins = [];

            const newId = Math.max(...winsData.todayWins.map(w => w.id), 0) + 1;
            winsData.todayWins.push({
                id: newId,
                text: text,
                completed: false
            });

            localStorage.setItem('winsData', JSON.stringify(winsData));
            input.value = '';
            renderWins();
        }

        function deleteWin(id) {
            const winsData = JSON.parse(localStorage.getItem('winsData') || '{}');
            winsData.todayWins = winsData.todayWins.filter(w => w.id !== id);
            localStorage.setItem('winsData', JSON.stringify(winsData));
            renderWins();
        }

        function renderWinsHistory() {
            const winsData = JSON.parse(localStorage.getItem('winsData') || '{}');
            const container = document.getElementById('winsHistory');

            if (!winsData.history || winsData.history.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìÖ</div>
                        <p>Your past victories will appear here!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = winsData.history.map(day => `
                <div class="history-day">
                    <p class="history-date">${formatDate(day.date)}</p>
                    <div class="history-wins">
                        ${day.wins.map(win => `<span class="history-win-tag">${win}</span>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        // Enter key to add win
        document.getElementById('newWinInput')?.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addWin();
        });

        // ==================== CALM SPACE ====================
        function toggleBreathing() {
            if (state.breathingActive) {
                stopBreathing();
            } else {
                startBreathing();
            }
        }

        function startBreathing() {
            state.breathingActive = true;
            document.getElementById('breathingBtn').textContent = 'Stop';

            const phases = breathingPatterns[state.breathingPattern];

            let phaseIndex = 0;
            let countdown = phases[0].duration;

            function updateBreathing() {
                const phase = phases[phaseIndex];
                const circle = document.getElementById('breathingCircle');
                const text = document.getElementById('breathingText');
                const instruction = document.getElementById('breathingInstruction');
                const timer = document.getElementById('breathingTimer');

                text.textContent = phase.name;
                instruction.textContent = `${phase.name} slowly...`;
                timer.textContent = countdown;

                circle.className = 'breathing-circle ' + phase.class;

                countdown--;

                if (countdown < 0) {
                    phaseIndex = (phaseIndex + 1) % phases.length;
                    countdown = phases[phaseIndex].duration;
                }
            }

            updateBreathing();
            state.breathingInterval = setInterval(updateBreathing, 1000);
        }

        function stopBreathing() {
            state.breathingActive = false;
            clearInterval(state.breathingInterval);

            document.getElementById('breathingBtn').textContent = 'Start Breathing Exercise';
            document.getElementById('breathingText').textContent = 'Ready';
            document.getElementById('breathingInstruction').textContent = 'Press start to begin the breathing exercise';
            document.getElementById('breathingTimer').textContent = '4';
            document.getElementById('breathingCircle').className = 'breathing-circle';
        }

        function toggleSound(soundType) {
            const soundMap = {
                rain: document.getElementById('rainSound'),
                forest: document.getElementById('forestSound'),
                waves: document.getElementById('wavesSound'),
                music: document.getElementById('musicSound')
            };

            const toggles = document.querySelectorAll('.sound-toggle');

            // If clicking the same sound, turn it off
            if (state.currentSound === soundType) {
                soundMap[soundType].pause();
                soundMap[soundType].currentTime = 0;
                state.currentSound = null;
                toggles.forEach(t => t.classList.remove('active'));
                return;
            }

            // Stop any currently playing sound
            Object.values(soundMap).forEach(audio => {
                audio.pause();
                audio.currentTime = 0;
            });

            // Play the selected sound
            soundMap[soundType].volume = 0.5;
            soundMap[soundType].play().catch(e => {
                console.log('Audio playback requires user interaction first');
            });

            state.currentSound = soundType;

            // Update UI
            toggles.forEach(t => {
                t.classList.toggle('active', t.dataset.sound === soundType);
            });
        }

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved theme
            loadTheme();
            
            // Update date and greeting
            updateDateDisplay();
            updateGreeting();
            
            // Initialize navigation
            initNavigation();
            
            // Load all data
            loadGratitudeEntries();
            initMoodTracker();
            newAffirmation();
            initWins();
            loadIntention();
            loadCustomAffirmations();
            
            // Update stats and streak
            updateStats();
            updateStreak();
            
            // Check for weekly reflection (Sundays)
            checkWeeklyReflection();
            
            // Initialize meditation display
            updateMeditationDisplay();
            
            // Check if first visit
            checkOnboarding();
            
            // Setup keyboard shortcuts
            initKeyboardShortcuts();

            // Enter key for gratitude
            document.getElementById('gratitudeInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && e.ctrlKey) {
                    saveGratitude();
                }
            });
            
            // Enter key for intention
            document.getElementById('intentionInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    saveIntention();
                }
            });
            
            // Enter key for custom affirmation
            document.getElementById('customAffirmationInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    addCustomAffirmation();
                }
            });
        });
    </script>
</body>
</html>

